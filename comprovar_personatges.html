<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <title>SitgesArt - Pendents de completar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="bg-slate-950 text-white p-6">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-black text-blue-400 mb-6">PERSONATGES QUE FALTEN üìù</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2">
                <div id="stats" class="mb-4 text-emerald-400 font-bold text-xl">Calculant...</div>
                <div id="graella" class="grid grid-cols-2 md:grid-cols-3 gap-2"></div>
            </div>

            <div class="bg-slate-900 p-6 rounded-2xl border border-slate-700 h-fit sticky top-6">
                <h2 class="text-xl font-bold mb-4 text-blue-300">Llista per copiar:</h2>
                <textarea id="llista-text" class="w-full h-96 bg-black/50 border border-slate-600 rounded-lg p-4 font-mono text-sm text-slate-300" readonly></textarea>
                <p class="text-xs text-slate-500 mt-2 italic">Copia aquests noms i envia'm-los al xat.</p>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAV8SrQ3tDiixCRwUDgC33jI8ZJzlcceZc",
            authDomain: "sitgesart.firebaseapp.com",
            projectId: "sitgesart",
            storageBucket: "sitgesart.firebasestorage.app",
            messagingSenderId: "673959867307",
            appId: "1:673959867307:web:80607c11d79db42b4918ee"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const llista100 = [
            "Santiago Rusi√±ol", "Ramon Casas", "Miquel Utrillo", "Arcadi Mas i Fondevila", "Joaquim de Mir√≥", "Joan Roig i Soler", "Antoni Almirall", "Felip Mas√≥", "Pere Jou", "Artur Carbonell",
            "Agust√≠ Ferrer Pino", "Alfred Sisquella", "Emili Grau Sala", "Lola Anglada", "Josep Maria Llopis de Cellers", "Salvador Dal√≠", "Federico Garc√≠a Lorca", "Manuel Blesa", "Jose Luis Fuentetaja", "Iris L√°zaro",
            "Joan Llaverias", "Pere Pruna", "Francesc Armengol", "Carlos V√°zquez", "Josep Planes i Pe√±alver", "Joan Maragall", "C√°ndida P√©rez", "Salvador Soler i Forment", "Josep Carbonell i Gener", "Trinitat Catas√∫s",
            "Miquel de Sitges", "Josep Maria de Sagarra", "Celia Su√±ol", "Gumersind Riera", "David Jou i Mirabent", "Vinyet Panyella", "Rafael Casanova", "Marta Pessarrodona", "J.V. Foix", "Carles Soldevila",
            "Charles Deering", "Facundo Bacard√≠", "Josep Mir√≥ i Argenter", "Bartomeu Robert", "Emerenci√† Roig i Ravent√≥s", "Josep Galofre", "Josep Bertran i Musitu", "Francesc Gum√† i Ferran", "Jaume Figueras", "Josep Davenport",
            "Salvador Sam√†", "Manuel Vidal-Quadras", "Josep Canals", "Antoni Mesa", "Albert Catas√∫s", "√Ängel Sala", "Janio Marti", "Gabriel Pallar√®s", "Enric Morera", "Manel Torrens",
            "Xavier Montsalvatge", "Anna Ricci", "Ovidi Montllor", "Pawel Rouba", "Lindsay Kemp", "Ricard Salvat", "Jordi Mil√°n", "Merc√® Comes", "Santi Mill√°n", "Jos√© Mojica",
            "Josep Maria Martino", "Gaiet√† Bu√Øgas", "Ignasi Mas i Morell", "Francesc Rogent", "Bonaventura Poll√©s", "Jaume Sunyer", "Josep Artigas", "Cini Boeri", "Coderch", "Pepito Pascual",
            "Jordi Pa√±ella", "Isidre Pa√±ella", "Franciscu de Sitges", "Agust√≠ Albors", "Miguel Cond√©", "Horacio Elena", "Bruno de Fabriziis", "Thomas Spieker", "Nati de Castellar", "Manuel Llopis de Casades",
            "Ramon de Dalmases", "Antonio Ba√±os", "Ada Parellada", "Suso Plaza", "Blanca de la Riva", "Gen√≠s Hern√°ndez", "Anna Monz√≥", "Carme Parellada", "Llu√≠s Jou", "Josep Manuel Soler"
        ];

        async function comparar() {
            const querySnapshot = await getDocs(collection(db, "obres"));
            const nomsA_BBDD = [];
            querySnapshot.forEach((doc) => {
                if (doc.data().nom) nomsA_BBDD.push(doc.data().nom.toLowerCase().trim());
            });

            const graella = document.getElementById('graella');
            const llistaTextarea = document.getElementById('llista-text');
            graella.innerHTML = "";
            let trobats = 0;
            let pendents = [];

            llista100.forEach(nom => {
                const existeix = nomsA_BBDD.some(n => n.includes(nom.toLowerCase().trim()));
                
                // Graella visual
                const div = document.createElement('div');
                div.className = `p-2 rounded border text-xs ${existeix ? 'bg-green-900/20 border-green-500 text-green-300' : 'bg-slate-800 border-slate-700 text-slate-500'}`;
                div.innerText = nom;
                graella.appendChild(div);

                if (existeix) {
                    trobats++;
                } else {
                    pendents.push(nom);
                }
            });

            document.getElementById('stats').innerText = `${trobats} / 100 Completats`;
            llistaTextarea.value = pendents.join("\n");
        }

        comparar();
    </script>
</body>
</html>
