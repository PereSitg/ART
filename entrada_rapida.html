<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <title>SitgesArt - Entrada R√†pida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        body { background: #020617; color: white; font-family: sans-serif; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .input-field { background: #0f172a; border: 1px solid #334155; border-radius: 12px; padding: 12px; width: 100%; color: white; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #94a3b8; font-size: 0.85rem; font-weight: 600; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-card" class="bg-slate-900 border border-slate-800 p-10 rounded-3xl shadow-2xl text-center">
        <h1 class="text-2xl font-bold mb-6">üîí Acc√©s Protegit</h1>
        <button onclick="login()" class="bg-white text-black font-bold py-3 px-8 rounded-full hover:bg-slate-200 transition-all">
            Identifica't com Admin
        </button>
    </div>

    <div id="form-card" class="bg-slate-900 border border-slate-800 p-8 rounded-3xl shadow-2xl w-full max-w-2xl hidden">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black text-blue-400">SITGES ART EXPRESS ‚ö°</h1>
            <span id="user-email" class="text-xs text-slate-500"></span>
        </div>

        <label>1. Tria un personatge de la llista:</label>
        <select id="selector" class="input-field border-blue-500/50 bg-slate-800 cursor-pointer" onchange="carregarDades()">
            <option value="">-- Selecciona per auto-completar --</option>
        </select>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label>Nom</label>
                <input type="text" id="nom" class="input-field">
            </div>
            <div>
                <label>Font</label>
                <input type="text" id="font" class="input-field">
            </div>
        </div>

        <label>URL (Viquip√®dia / Web)</label>
        <input type="text" id="url" class="input-field text-blue-300 text-sm">

        <label>Resum per a la web</label>
        <textarea id="resum" class="input-field h-32 text-sm leading-relaxed"></textarea>

        <button onclick="guardarAFirebase()" id="btn-save" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-900/20 transition-all">
            GUARDAR ARA MATEIX
        </button>
        
        <p id="status" class="mt-4 text-center font-bold"></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAV8SrQ3tDiixCRwUDgC33jI8ZJzlcceZc",
            authDomain: "sitgesart.firebaseapp.com",
            projectId: "sitgesart",
            storageBucket: "sitgesart.firebasestorage.app",
            messagingSenderId: "673959867307",
            appId: "1:673959867307:web:80607c11d79db42b4918ee"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // BASE DE DADES INTERNA PER ANAR R√ÄPID
       const dadesPersonatges = {
            "Manuel Vidal-Quadras": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Manuel_Vidal-Quadras_i_Ramon", resum: "Bancer i col¬∑leccionista d'art vinculat a la burgesia barcelonina amb fortes arrels i llegat a Sitges." },
            "Josep Canals": { font: "Web", url: "https://www.canalsgaleriaart.cat", resum: "Gallerista i promotor d'art que ha treballat intensament per la difusi√≥ dels artistes de la vila i del Pened√®s." },
            "Albert Catas√∫s": { font: "Web", url: "https://ca.wikipedia.org/wiki/Albert_Catas√∫s", resum: "Historiador de l'art especialitzat en el Modernisme i el Noucentisme a Sitges, col¬∑laborador de museus." },
            "Manel Torrens": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Manel_Torrens_i_Gironella", resum: "Compositor de sardanes i m√∫sic molt actiu en la vida cultural sitgetana i en la seva Festa Major." },
            "Xavier Montsalvatge": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Xavier_Montsalvatge_i_Bassols", resum: "Un dels compositors catalans m√©s influents del segle XX, amb estades i vincles art√≠stics a la nostra vila." },
            "Anna Ricci": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Anna_Ricci", resum: "Mezzosoprano catalana d'un gust exquisit que va triar Sitges com un dels seus refugis de creaci√≥ i vida." },
            "Ovidi Montllor": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Ovidi_Montllor_i_Mengual", resum: "Actor i cantautor de la Nova Can√ß√≥ que va viure una etapa significativa a Sitges, integrat en la seva cultura." },
            "Pawel Rouba": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Pawel_Rouba", resum: "Mestre de mim i pantomima polon√®s resident a Sitges, que va formar generacions d'actors des de la vila." },
            "Lindsay Kemp": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Lindsay_Kemp", resum: "Core√≤graf i mim brit√†nic de fama mundial, estretament vinculat al Festival de Teatre de Sitges." },
            "Ricard Salvat": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Ricard_Salvat_i_Ferr√©", resum: "Director teatral i escriptor, una de les figures m√©s importants de l'escena catalana i del Festival sitget√†." },
            "Merc√® Comes": { font: "Web", url: "https://ca.wikipedia.org/wiki/Merc√®_Comes", resum: "Actriu c√≤mica nascuda o vinculada professionalment a Sitges a trav√©s de la companyia La Cubana." },
            "Jos√© Mojica": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Jos√©_Mojica", resum: "Tenor i actor mexic√† que va viure a Sitges abans de fer-se frare, deixant una forta empremta popular." },
            "Ignasi Mas i Morell": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Ignasi_Mas_i_Morell", resum: "Arquitecte modernista i noucentista, autor d'edificis tan emblem√†tics com l'antic escorxador de Sitges." },
            "Bonaventura Poll√©s": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Bonaventura_Poll√©s_i_Viv√≥", resum: "Arquitecte actiu a finals del XIX i principis del XX, autor de diversos xalets i cases de reforma a la vila." },
            "Jaume Sunyer": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Jaume_Sunyer_i_Juncosa", resum: "Arquitecte sitget√† autor de nombroses obres d'estil modernista que defineixen el perfil urb√† local." }
        };

        // Identificaci√≥
        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "pbadialorenz@gmail.com") {
                document.getElementById('login-card').classList.add('hidden');
                document.getElementById('form-card').classList.remove('hidden');
                document.getElementById('user-email').innerText = user.email;
                carregarLlista();
            }
        });

        window.login = () => signInWithPopup(auth, provider);

        function carregarLlista() {
            const selector = document.getElementById('selector');
            for (let nom in dadesPersonatges) {
                let opt = document.createElement('option');
                opt.value = nom;
                opt.innerText = nom;
                selector.appendChild(opt);
            }
        }

        window.carregarDades = () => {
            const sel = document.getElementById('selector').value;
            if (dadesPersonatges[sel]) {
                document.getElementById('nom').value = sel;
                document.getElementById('font').value = dadesPersonatges[sel].font;
                document.getElementById('url').value = dadesPersonatges[sel].url;
                document.getElementById('resum').value = dadesPersonatges[sel].resum;
            }
        };

        window.guardarAFirebase = async () => {
            const status = document.getElementById('status');
            const btn = document.getElementById('btn-save');
            
            const docData = {
                nom: document.getElementById('nom').value,
                font: document.getElementById('font').value,
                link: document.getElementById('url').value,
                resum: document.getElementById('resum').value,
                data_entrada: new Date().toISOString()
            };

            if (!docData.nom) return alert("Tria un personatge primer!");

            try {
                btn.disabled = true;
                status.innerText = "‚è≥ Guardant a Firebase...";
                await addDoc(collection(db, "obres"), docData);
                status.innerText = "‚úÖ Guardat correctament!";
                status.className = "mt-4 text-center font-bold text-green-400";
                
                // Neteja per al seg√ºent
                setTimeout(() => {
                    status.innerText = "";
                    document.getElementById('nom').value = "";
                    document.getElementById('resum').value = "";
                    document.getElementById('url').value = "";
                    document.getElementById('selector').value = "";
                }, 2000);

            } catch (e) {
                status.innerText = "‚ùå Error: " + e.message;
                status.className = "mt-4 text-center font-bold text-red-400";
                console.error(e);
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
