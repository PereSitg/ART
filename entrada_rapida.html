<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <title>SitgesArt - Entrada R√†pida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        body { background: #020617; color: white; font-family: sans-serif; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .input-field { background: #0f172a; border: 1px solid #334155; border-radius: 12px; padding: 12px; width: 100%; color: white; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #94a3b8; font-size: 0.85rem; font-weight: 600; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-card" class="bg-slate-900 border border-slate-800 p-10 rounded-3xl shadow-2xl text-center">
        <h1 class="text-2xl font-bold mb-6">üîí Acc√©s Protegit</h1>
        <button onclick="login()" class="bg-white text-black font-bold py-3 px-8 rounded-full hover:bg-slate-200 transition-all">
            Identifica't com Admin
        </button>
    </div>

    <div id="form-card" class="bg-slate-900 border border-slate-800 p-8 rounded-3xl shadow-2xl w-full max-w-2xl hidden">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black text-blue-400">SITGES ART EXPRESS ‚ö°</h1>
            <span id="user-email" class="text-xs text-slate-500"></span>
        </div>

        <label>1. Tria un personatge de la llista:</label>
        <select id="selector" class="input-field border-blue-500/50 bg-slate-800 cursor-pointer" onchange="carregarDades()">
            <option value="">-- Selecciona per auto-completar --</option>
        </select>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label>Nom</label>
                <input type="text" id="nom" class="input-field">
            </div>
            <div>
                <label>Font</label>
                <input type="text" id="font" class="input-field">
            </div>
        </div>

        <label>URL (Viquip√®dia / Web)</label>
        <input type="text" id="url" class="input-field text-blue-300 text-sm">

        <label>Resum per a la web</label>
        <textarea id="resum" class="input-field h-32 text-sm leading-relaxed"></textarea>

        <button onclick="guardarAFirebase()" id="btn-save" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-900/20 transition-all">
            GUARDAR ARA MATEIX
        </button>
        
        <p id="status" class="mt-4 text-center font-bold"></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAV8SrQ3tDiixCRwUDgC33jI8ZJzlcceZc",
            authDomain: "sitgesart.firebaseapp.com",
            projectId: "sitgesart",
            storageBucket: "sitgesart.firebasestorage.app",
            messagingSenderId: "673959867307",
            appId: "1:673959867307:web:80607c11d79db42b4918ee"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // BASE DE DADES INTERNA PER ANAR R√ÄPID
      const dadesPersonatges = {
            "Josep Artigas": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Josep_Artigas_i_Ojeda", resum: "Un dels cartellistes i dissenyadors gr√†fics catalans m√©s internacionals; va viure i treballar a Sitges molts anys." },
            "Cini Boeri": { font: "Viquip√®dia", url: "https://it.wikipedia.org/wiki/Cini_Boeri", resum: "Arquitecta i dissenyadora italiana de gran prestigi que va deixar la seva empremta a Sitges amb la Casa Bunker." },
            "Coderch": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Josep_Antoni_Coderch_i_de_Sentmenat", resum: "Josep Antoni Coderch, l'arquitecte m√©s important de la postguerra, autor d'edificis magistrals a la costa sitgetana." },
            "Pepito Pascual": { font: "Web", url: "https://www.l'eco.cat", resum: "M√∫sic multiinstrumentista i √†nima lliure de la cultura sitgetana, col¬∑laborador de Pascal Comelade i molts altres." },
            "Jordi Pa√±ella": { font: "Web", url: "https://www.visitsitges.com", resum: "Figura clau de la cultura popular, molt vinculat a la conservaci√≥ de les tradicions i a la hist√≤ria del Carnaval." },
            "Isidre Pa√±ella": { font: "Web", url: "https://ca.wikipedia.org/wiki/Isidre_Pa√±ella_i_Virella", resum: "Mestre pirot√®cnic de refer√®ncia, responsable durant d√®cades de l'espectacular Castell de Foc de la Festa Major." },
            "Agust√≠ Albors": { font: "Web", url: "https://www.sitges.cat", resum: "Activista cultural i prohom de la vila, sempre implicat en les institucions i la preservaci√≥ del patrimoni." },
            "Miguel Cond√©": { font: "Viquip√®dia", url: "https://en.wikipedia.org/wiki/Miguel_Cond√©", resum: "Pintor i gravador mexic√† de reconeixement mundial que t√© el seu taller i resid√®ncia a Sitges des de fa d√®cades." },
            "Horacio Elena": { font: "Web", url: "https://www.horacioelena.es", resum: "Il¬∑lustrador de llibres infantils i artista resident a Sitges, amb una obra plena de tendresa i color." },
            "Bruno de Fabriziis": { font: "Web", url: "https://www.brunoart.com", resum: "Artista polifac√®tic i escultor resident a Sitges, conegut per les seves formes org√†niques i el treball amb el ferro." },
            "Thomas Spieker": { font: "Web", url: "https://www.l'eco.cat", resum: "Periodista alemany arrelat a Sitges, gran ambaixador de la vila i cronista de la vida internacional a la costa." },
            "Nati de Castellar": { font: "Web", url: "https://www.sitgesheritages.com", resum: "Ballarina i figura m√≠tica de l'espectacle a Sitges, recordada per la seva eleg√†ncia i passi√≥ per la dansa." },
            "Manuel Llopis de Casades": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Llegat_Llopis", resum: "L'√∫ltim propietari de la Casa Llopis (Museu Rom√†ntic), qui va llegar el seu patrimoni i el celler de Malvasia a la Generalitat." },
            "Ramon de Dalmases": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Ramon_de_Dalmases_i_de_Olabarr√≠a", resum: "Marqu√®s de Mura, bibli√≤fil i personatge de la societat sitgetana que va viure al Palau de Maricel." },
            "Antonio Ba√±os": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Antonio_Ba√±os_i_Boncompain", resum: "Periodista i escriptor resident a Sitges, conegut per la seva an√†lisi pol√≠tica i social i la seva estima per la vila." }
        };

        // Identificaci√≥
        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "pbadialorenz@gmail.com") {
                document.getElementById('login-card').classList.add('hidden');
                document.getElementById('form-card').classList.remove('hidden');
                document.getElementById('user-email').innerText = user.email;
                carregarLlista();
            }
        });

        window.login = () => signInWithPopup(auth, provider);

        function carregarLlista() {
            const selector = document.getElementById('selector');
            for (let nom in dadesPersonatges) {
                let opt = document.createElement('option');
                opt.value = nom;
                opt.innerText = nom;
                selector.appendChild(opt);
            }
        }

        window.carregarDades = () => {
            const sel = document.getElementById('selector').value;
            if (dadesPersonatges[sel]) {
                document.getElementById('nom').value = sel;
                document.getElementById('font').value = dadesPersonatges[sel].font;
                document.getElementById('url').value = dadesPersonatges[sel].url;
                document.getElementById('resum').value = dadesPersonatges[sel].resum;
            }
        };

        window.guardarAFirebase = async () => {
            const status = document.getElementById('status');
            const btn = document.getElementById('btn-save');
            
            const docData = {
                nom: document.getElementById('nom').value,
                font: document.getElementById('font').value,
                link: document.getElementById('url').value,
                resum: document.getElementById('resum').value,
                data_entrada: new Date().toISOString()
            };

            if (!docData.nom) return alert("Tria un personatge primer!");

            try {
                btn.disabled = true;
                status.innerText = "‚è≥ Guardant a Firebase...";
                await addDoc(collection(db, "obres"), docData);
                status.innerText = "‚úÖ Guardat correctament!";
                status.className = "mt-4 text-center font-bold text-green-400";
                
                // Neteja per al seg√ºent
                setTimeout(() => {
                    status.innerText = "";
                    document.getElementById('nom').value = "";
                    document.getElementById('resum').value = "";
                    document.getElementById('url').value = "";
                    document.getElementById('selector').value = "";
                }, 2000);

            } catch (e) {
                status.innerText = "‚ùå Error: " + e.message;
                status.className = "mt-4 text-center font-bold text-red-400";
                console.error(e);
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
