<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <title>SitgesArt - Entrada R√†pida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        body { background: #020617; color: white; font-family: sans-serif; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .input-field { background: #0f172a; border: 1px solid #334155; border-radius: 12px; padding: 12px; width: 100%; color: white; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #94a3b8; font-size: 0.85rem; font-weight: 600; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-card" class="bg-slate-900 border border-slate-800 p-10 rounded-3xl shadow-2xl text-center">
        <h1 class="text-2xl font-bold mb-6">üîí Acc√©s Protegit</h1>
        <button onclick="login()" class="bg-white text-black font-bold py-3 px-8 rounded-full hover:bg-slate-200 transition-all">
            Identifica't com Admin
        </button>
    </div>

    <div id="form-card" class="bg-slate-900 border border-slate-800 p-8 rounded-3xl shadow-2xl w-full max-w-2xl hidden">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-black text-blue-400">SITGES ART EXPRESS ‚ö°</h1>
            <span id="user-email" class="text-xs text-slate-500"></span>
        </div>

        <label>1. Tria un personatge de la llista:</label>
        <select id="selector" class="input-field border-blue-500/50 bg-slate-800 cursor-pointer" onchange="carregarDades()">
            <option value="">-- Selecciona per auto-completar --</option>
        </select>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label>Nom</label>
                <input type="text" id="nom" class="input-field">
            </div>
            <div>
                <label>Font</label>
                <input type="text" id="font" class="input-field">
            </div>
        </div>

        <label>URL (Viquip√®dia / Web)</label>
        <input type="text" id="url" class="input-field text-blue-300 text-sm">

        <label>Resum per a la web</label>
        <textarea id="resum" class="input-field h-32 text-sm leading-relaxed"></textarea>

        <button onclick="guardarAFirebase()" id="btn-save" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-900/20 transition-all">
            GUARDAR ARA MATEIX
        </button>
        
        <p id="status" class="mt-4 text-center font-bold"></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAV8SrQ3tDiixCRwUDgC33jI8ZJzlcceZc",
            authDomain: "sitgesart.firebaseapp.com",
            projectId: "sitgesart",
            storageBucket: "sitgesart.firebasestorage.app",
            messagingSenderId: "673959867307",
            appId: "1:673959867307:web:80607c11d79db42b4918ee"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // BASE DE DADES INTERNA PER ANAR R√ÄPID
     const dadesPersonatges = {
            "Ada Parellada": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Ada_Parellada_i_Garrell", resum: "Reconeguda cuinera de la nissaga dels Parellada, amb forts vincles familiars i gastron√≤mics a Sitges." },
            "Carme Parellada": { font: "Web", url: "https://www.l'eco.cat", resum: "Historiadora i activista cultural, una de les veus m√©s autoritzades per parlar de la genealogia sitgetana." },
            "Suso Plaza": { font: "Web", url: "https://www.susoplaza.com", resum: "Pintor contemporani resident a Sitges, la seva obra destaca per l'√∫s del color i una visi√≥ molt personal del paisatge." },
            "Blanca de la Riva": { font: "Web", url: "https://www.blancadelariva.com", resum: "Artista visual i pintora amb taller a Sitges, coneguda per les seves composicions abstractes i expressives." },
            "Gen√≠s Hern√°ndez": { font: "Web", url: "https://www.genishernandez.com", resum: "Artista polifac√®tic que treballa la imatge i la pl√†stica, vinculat a les noves generacions de creadors sitgetans." },
            "Anna Monz√≥": { font: "Web", url: "https://www.annamonzo.com", resum: "Joieria art√≠stica contempor√†nia amb segell sitget√†, que fusiona disseny i artesania d'alt nivell." },
            "Josep Manuel Soler": { font: "Web", url: "https://www.l'eco.cat", resum: "Periodista i ex-director de L'Eco de Sitges, figura clau per entendre la cr√≤nica local de les darreres d√®cades." },
            "Gumersind Riera": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Gumersind_Riera_i_Sans", resum: "Poeta d'origen menorqu√≠ establert a Sitges, molt actiu en els cert√†mens literaris i la vida cultural de la vila." },
            "Celia Su√±ol": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Celia_Su√±ol_i_Pla", resum: "Escriptora que va reflectir en la seva literatura la vida de la burgesia i els canvis socials del seu temps." },
            "Josep Davenport": { font: "Web", url: "https://www.l'eco.cat", resum: "Personatge hist√≤ric lligat a les fam√≠lies 'americanes' que van transformar el perfil arquitect√≤nic de Sitges." },
            "Antoni Mesa": { font: "Web", url: "https://www.l'eco.cat", resum: "Investigador i cronista de la hist√≤ria local, especialitzat en la recuperaci√≥ de la mem√≤ria oral i documental." },
            "Miquel de Sitges": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Miquel_de_Sitges", resum: "Escriptor i religi√≥s caputx√≠ que va portar el nom de la vila a la seva producci√≥ intel¬∑lectual i liter√†ria." },
            "Josep Galofre": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Josep_Galofre_i_Coma", resum: "Pintor rom√†ntic que, tot i la seva carrera internacional, va mantenir vincles amb els artistes que s'instal¬∑laven a Sitges." },
            "Salvador Sam√†": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Salvador_Sam√†_i_Torrents", resum: "Marqu√®s de Marianao i pol√≠tic, impulsor de projectes arquitect√≤nics i urban√≠stics de gran rellev√†ncia." },
            "Bartomeu Robert": { font: "Viquip√®dia", url: "https://ca.wikipedia.org/wiki/Bartomeu_Robert_i_Yarz√°bal", resum: "Conegut com el Doctor Robert, metge i pol√≠tic fill de sitgetans, s√≠mbol del catalanisme i la ci√®ncia del segle XIX." }
        };

        // Identificaci√≥
        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "pbadialorenz@gmail.com") {
                document.getElementById('login-card').classList.add('hidden');
                document.getElementById('form-card').classList.remove('hidden');
                document.getElementById('user-email').innerText = user.email;
                carregarLlista();
            }
        });

        window.login = () => signInWithPopup(auth, provider);

        function carregarLlista() {
            const selector = document.getElementById('selector');
            for (let nom in dadesPersonatges) {
                let opt = document.createElement('option');
                opt.value = nom;
                opt.innerText = nom;
                selector.appendChild(opt);
            }
        }

        window.carregarDades = () => {
            const sel = document.getElementById('selector').value;
            if (dadesPersonatges[sel]) {
                document.getElementById('nom').value = sel;
                document.getElementById('font').value = dadesPersonatges[sel].font;
                document.getElementById('url').value = dadesPersonatges[sel].url;
                document.getElementById('resum').value = dadesPersonatges[sel].resum;
            }
        };

        window.guardarAFirebase = async () => {
            const status = document.getElementById('status');
            const btn = document.getElementById('btn-save');
            
            const docData = {
                nom: document.getElementById('nom').value,
                font: document.getElementById('font').value,
                link: document.getElementById('url').value,
                resum: document.getElementById('resum').value,
                data_entrada: new Date().toISOString()
            };

            if (!docData.nom) return alert("Tria un personatge primer!");

            try {
                btn.disabled = true;
                status.innerText = "‚è≥ Guardant a Firebase...";
                await addDoc(collection(db, "obres"), docData);
                status.innerText = "‚úÖ Guardat correctament!";
                status.className = "mt-4 text-center font-bold text-green-400";
                
                // Neteja per al seg√ºent
                setTimeout(() => {
                    status.innerText = "";
                    document.getElementById('nom').value = "";
                    document.getElementById('resum').value = "";
                    document.getElementById('url').value = "";
                    document.getElementById('selector').value = "";
                }, 2000);

            } catch (e) {
                status.innerText = "‚ùå Error: " + e.message;
                status.className = "mt-4 text-center font-bold text-red-400";
                console.error(e);
            } finally {
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
