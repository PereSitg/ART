<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <title>Correcci√≥ Final SitgesArt</title>
</head>
<body style="font-family: sans-serif; padding: 30px; background: #f4f4f4;">
    <h1 id="estat">Connectant amb Firebase...</h1>
    <div id="llista" style="background: white; border: 1px solid #ccc; padding: 20px; max-height: 500px; overflow-y: auto;">
        Esperant...
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs, updateDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAV8SrQ3tDiixCRwUDgC33jI8ZJzlcceZc",
            authDomain: "sitgesart.firebaseapp.com",
            projectId: "sitgesart",
            storageBucket: "sitgesart.firebasestorage.app",
            messagingSenderId: "673959867307",
            appId: "1:673959867307:web:80607c11d79db42b4918ee"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function corregir() {
            const estat = document.getElementById('estat');
            const llista = document.getElementById('llista');
            
            try {
                const snapshot = await getDocs(collection(db, "obres"));
                let total = 0;

                for (const docSnap of snapshot.docs) {
                    const d = docSnap.data();
                    const link = (d.link || "").toLowerCase();

                    // Condici√≥ per trobar els articles de la Beli Artigas
                    if (link.includes("criticart.blogspot") || link.includes("criticartt.blogspot")) {
                        await updateDoc(doc(db, "obres", docSnap.id), {
                            font: "BELI ARTIGAS", // Etiqueta superior
                            origen: "Criticart"   // Text inferior
                        });
                        llista.innerHTML += "‚úÖ Actualitzat: " + d.nom + "<br>";
                        total++;
                    }
                }
                estat.innerText = "üéâ FET! S'han actualitzat " + total + " entrades.";
            } catch (err) {
                estat.innerText = "‚ùå Error";
                llista.innerHTML = err.message + "<br><br>Recorda obrir les Rules a Firebase!";
            }
        }

        // Executem la funci√≥
        corregir();
    </script>
</body>
</html>
